<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.2//RU">
<HTML><HEAD>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=Windows-1251">
<TITLE>Лабораторная работа 3.2</TITLE>


</HEAD> 

<BODY BGCOLOR="#FFEFCF" 
 TEXT="black" LINK="blue" ALINK="red" VLINK="green">
<h1> cookie </h1>

<SCRIPT language="JavaScript">


function set_cookie(name, visits) {
    // Счетчик числа посещений с указанием даты последнего посещения и определением срока хранения в 1 год. 
    let expireDate = new Date();
    let today = new Date();
    document.cookie = "name=" + name + ";";
    // Установка даты истечения срока хранения.
    expireDate.setDate(365 + expireDate.getDate());
    // Сохранение числа посещений.
    document.cookie = "visits=" + visits + ";";
    // Сохранение настоящей даты как времени последнего посещения.
    document.cookie = "LastVisit=" + escape(today.toGMTString()) + "; expires=" + expireDate.toGMTString() + ";";
    }

function delete_cookie ( cookie_name )
{
  let cookie_date = new Date ();  //Ткущая дата и время
  cookie_date.setTime ( cookie_date.getTime() - 1 );
  document.cookie = cookie_name += "=; expires=" + cookie_date.toGMTString();
}

function get_cookie(name) {
  let matches = document.cookie.match(new RegExp(
    "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
  ));
  return matches ? decodeURIComponent(matches[1]) : undefined;
}
 
function update(){
    let visits = get_cookie("visits");
    document.cookie = "visits=" + (visits + 1);
}

if ( ! get_cookie("name"))
{
    document.write("Приветствую! <br>Зарегистрируйся на моём сайте: <br>");
    document.write("Введите имя: <input type='text' id='input'>");
    document.write("<br><br><input type='button' id='login' value='Зарегистрироваться'>");
    document.location.reload();
  
}
else
{
    update;
    document.write("Привет, " + get_cookie("name") + "!<br>");
    document.write(document.cookie);
}
  login.onclick = function(){
    set_cookie(input.value, 1);
}

</SCRIPT>
</BODY>
</HTML>
